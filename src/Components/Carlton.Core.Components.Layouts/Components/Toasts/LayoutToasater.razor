@using Carlton.Core.Components.Toasts
@namespace Carlton.Core.Components.Layouts.Toasts

<div class="layout-toaster">
    @if (IsTestMode)
    {
       <LayoutToasterTestPanel ToastIndex="ToastIndex" GenerateNotification="GenerateNotification" />
    }

    <div class="content" style="@ContentStyle">
        @foreach (var vm in Toasts)
        {
            <Toast ViewModel="@vm" />
        }
    </div>
</div>



@code {
    [Parameter]
    public bool IsTestMode { get; set; }
    [Parameter]
    public bool FadeOutEnabled { get; set; }
    [Parameter]
    public int Top { get; set; }
    [Parameter]
    public int Right { get; set; }

    private int ToastIndex { get; set; }

    private List<ToastViewModel> Toasts { get; } = new List<ToastViewModel>();

    public void GenerateNotification(ToastViewModel newToast)
    {
        Toasts.Add(newToast);
        ToastIndex++;
        StateHasChanged();
    }

    private string ContentStyle
    {
        get => new StyleBuilder()
                .AddStyle("--toast-top", $"{Top}px")
                .AddStyle("--toast-right", $"{Right}px")
                .Build();
    }
}

